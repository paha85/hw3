Добрый день!
Самое сложное задание для меня.
За 4-ое даже не стал браться, старался хотя бы в этом разобраться, в том числе и в написании задания.
Cмог сделать так, чтобы каждый список начинался с новой строки, в одну строку было не очень красиво,
хотя код проще и короче.
В целом не могу сказать, что код мой, но я постарался максимально в нем разобраться,
хотя повторить первую часть будет затруднительно.